# –ü–∞–∫–µ—Ç pkg

–ü–∞–∫–µ—Ç `pkg` —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—É–±–ª–∏—á–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –∏ —É—Ç–∏–ª–∏—Ç—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –¥—Ä—É–≥–∏–º–∏ –ø—Ä–æ–µ–∫—Ç–∞–º–∏. –≠—Ç–æ –æ–±—â–µ–¥–æ—Å—Ç—É–ø–Ω—ã–π API –ø—Ä–æ–µ–∫—Ç–∞.

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–∫–µ—Ç–∞

```
pkg/
‚îú‚îÄ‚îÄ README.md          # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–∞–∫–µ—Ç–∞
‚îú‚îÄ‚îÄ README.go          # Go –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îî‚îÄ‚îÄ errors/            # –ü—É–±–ª–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏
    ‚îú‚îÄ‚îÄ users.go       # –û—à–∏–±–∫–∏ —Ä–∞–±–æ—Ç—ã —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
    ‚îî‚îÄ‚îÄ users_test.go  # –¢–µ—Å—Ç—ã –æ—à–∏–±–æ–∫
```

## üîó –ü–æ–¥–ø–∞–∫–µ—Ç—ã

### pkg/errors

–ü–∞–∫–µ—Ç `pkg/errors` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å–∏—Å—Ç–µ–º—É –æ—à–∏–±–æ–∫ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–æ–º –æ—Ç–≤–µ—Ç–∞.

#### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç –æ—à–∏–±–æ–∫**: `{"error": "message", "code": "ERROR_CODE"}`
- **HTTP —Å—Ç–∞—Ç—É—Å –º–∞–ø–ø–∏–Ω–≥**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ —Å HTTP —Å—Ç–∞—Ç—É—Å–∞–º–∏
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –ó–∞—â–∏—Ç–∞ –æ—Ç —É—Ç–µ—á–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –æ—à–∏–±–æ–∫
- **–í–∞–ª–∏–¥–∞—Ü–∏—è**: –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–æ–ª–µ–π

#### –¢–∏–ø—ã –æ—à–∏–±–æ–∫

| –¢–∏–ø –æ—à–∏–±–∫–∏ | HTTP —Å—Ç–∞—Ç—É—Å | –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------------|-------------|-------------|----------|
| –í–∞–ª–∏–¥–∞—Ü–∏—è | 400 | `USER_FIRST_NAME_EMPTY` | –ü—É—Å—Ç–æ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö | 500 | `USER_DATABASE_ERROR` | –û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞ |
| –ù–µ –Ω–∞–π–¥–µ–Ω–æ | 404 | `USER_NOT_FOUND` | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç |
| –ö–æ–Ω—Ñ–ª–∏–∫—Ç | 409 | `USER_ALREADY_EXISTS` | –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö |

#### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```go
package main

import (
    "net/http"
    "github.com/chybatronik/goUserAPI/pkg/errors"
)

func handleUserCreation(w http.ResponseWriter, r *http.Request) {
    // –í–∞–ª–∏–¥–∞—Ü–∏—è –∏–º–µ–Ω–∏
    if firstName == "" {
        userErr := errors.NewUserValidationError(
            "USER_FIRST_NAME_EMPTY",
            "First name cannot be empty",
        )
        writeErrorResponse(w, userErr.GetHTTPStatus(), userErr)
        return
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    if userExists {
        userErr := errors.NewUserConflictError(
            "USER_ALREADY_EXISTS",
            "User with this email already exists",
        )
        writeErrorResponse(w, userErr.GetHTTPStatus(), userErr)
        return
    }
}
```

#### –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä—ã –æ—à–∏–±–æ–∫

```go
// –û—à–∏–±–∫–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (400 Bad Request)
errors.NewUserValidationError(code, message)

// –û—à–∏–±–∫–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è (404 Not Found)
errors.NewUserNotFoundError(userID)

// –û—à–∏–±–∫–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞ (409 Conflict)
errors.NewUserConflictError(code, message)

// –û—à–∏–±–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (500 Internal Server Error)
errors.NewUserDatabaseError(message)
```

#### –£—Ç–∏–ª–∏—Ç—ã

```go
// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–∞ –æ—à–∏–±–∫–∏
if errors.IsUserError(err) {
    userErr, _ := errors.GetUserError(err)
    fmt.Printf("Error code: %s", userErr.Code)
}

// –ú–∞–ø–ø–∏–Ω–≥ –æ—à–∏–±–æ–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
userErr := errors.MapValidationError("first_name", "empty")
```

## üéØ –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

–ü–∞–∫–µ—Ç `pkg` –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è:

1. **–ü–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**: –ö–æ–¥ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤–Ω–µ—à–Ω–∏–º–∏ –ø—Ä–æ–µ–∫—Ç–∞–º–∏
2. **–°—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ API**: –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è
3. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**: –ß–µ—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
4. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è**: –ö–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏

## üìã –°–æ–≥–ª–∞—à–µ–Ω–∏—è

- **–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ**: –°–ª–µ–¥—É–µ—Ç —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–º—É –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—é
- **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: –í—Å–µ –ø—É–±–ª–∏—á–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é
- **–¢–µ—Å—Ç—ã**: –í—Å–µ –ø—É–±–ª–∏—á–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å —Ç–µ—Å—Ç—ã